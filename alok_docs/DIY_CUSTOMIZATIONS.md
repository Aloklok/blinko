# DIY 定制日志

本文档记录了本 Fork 仓库相对于官方上游仓库 (`blinkospace/blinko`) 所做的**个性化定制**，主要满足特定用户体验需求。

> [!NOTE]
> 这些修改是**非标准化**的，可能不适合所有用户。
> 如需同步上游更新，请注意这些文件的合并冲突。

---

## 1. 个性化交互 (UI/UX Tweaks)

此部分为满足特定用户体验而做的修改，从 `blinko-64-dmg` 的 `disable-interactions.patch` 移植而来。

| 功能 | 变更内容 | 原因 |
| :--- | :--- | :--- |
| **禁止滑动** | 移除了移动端的左右滑动交互 (`react-swipeable`) | 旧设备触摸板/鼠标容易误触左滑删除 |
| **禁止拖拽** | 禁用了看板的拖拽重排功能 (`dnd-kit`) | 避免误操作，保持布局静态 |
| **精简按钮** | 隐藏了卡片头部的 "Share" 和 "History" 按钮 | 减少视觉干扰，功能极简主义 |
| **字体颜色** | 强制 Light Mode 下正文颜色为 `#323232` | 提升文字对比度和可读性 |
| **交互动画** | 移除了卡片 Hover 时的上浮位移 | 减少页面抖动，提升稳重感 |
| **UI 洁癖** | 隐藏了 **Trash Icon** (垃圾桶) | 极致极简，防止误删 |
| **极致精简** | 隐藏了 **Comment** (顶部评论)、**Edit Time**、**Convert** 按钮 | 仅保留核心阅读区，排除低频干扰 |
| **空间呼吸** | 卡片 Header 底部间距增加 (`mb-3`) | 优化视觉层次，避免信息拥挤 |

---

## 2. Flomo 风格排版 (Style Overhaul)

为了追求极致的中文阅读体验，我们引入了一套类 Flomo 的排版规范 (`globals.css`)：

*   **排版几何**:
    *   **行高**: 锁定 `1.8` (原 1.5)，增加行间呼吸感。
    *   **字号**: 锁定 `15px` (原 14/16px)，移动端阅读的最佳平衡点。
    *   **两端对齐**: 启用 `text-justify: inter-character`，让块状文本更整齐。
    *   **段落重置**: 移除 `p` 标签的默认 margin，消除割裂感。
*   **组件微调**:
    *   **标签 (Tag)**: 圆角由 7px 收缩为 4px，视觉更硬朗干练。
    *   **数字**: 启用 `proportional-nums` (比例数字)，让时间戳更精致。

---

## 3. 移动端编辑器重构 (Mobile Editor Overhaul)

针对 iPhone SE 等小屏设备进行了深度的交互反馈与布局重构，确保极致的触控体验。

### 3.1 双层工具栏架构
*   **Top Row**: 复用 Vditor 原生工具栏，负责基础格式（加粗、列表、Emoji），确保 100% 的状态同步稳定性。
*   **Bottom Row**: 自定义 React 组件，集成业务逻辑（笔记类型、标签、引用、AI、附件、全屏）。

### 3.2 触控人体工学 (Ergonomics)
*   **超大点击位**: 底部按钮统一采用 **50px** 容器（原 32px 左右），图标放大至 **26px**，极大降低了误触率。
*   **高质感录音按钮**: 采用 `solar:soundwave-bold` 绿色通透图标，移除实心背景以保持视觉灵动感。

### 3.3 全屏高度修正 (Layout Fix)
*   **问题**: 移动端弹出框全屏模式下，编辑器无法自动撑开，导致底部工具栏悬浮在屏幕中间。
*   **方案**: 解耦了全屏类名与顶部工具栏显示状态的依赖关系。强制在 `store.isFullscreen` 为真时应用 `flex-1` 和 `fullscreen-editor` 类。
*   **结论**: 实现了移动端编辑器的"沉浸式"创作体验，内容区自动铺满视口，工具栏强制沉底。

---

## 4. 构建流深度优化 (Workflow Optimization)

移除了所有非核心的 CI/CD 流程，专注于 "Monterey Intel Mac" 私有化构建与 "Zeabur Docker" 部署。

*   **App Release**:
    *   **删减**: 移除 Windows / Linux / Android / Apple Silicon 构建矩阵。
    *   **锁定**: 仅保留 `macos-15-intel` (x86_64)，直接产出兼容 macOS 12 (Monterey) 的 DMG。
*   **Docker Release**:
    *   **策略**: 保留 `amd64` + `arm64` 双架构构建，确保 Zeabur 等 PaaS 平台的兼容性。
*   **环境净化**:
    *   删除了 `docker-build.yml` (临时)、`translator.yml` 等 5 个冗余工作流文件。

---

## 5. 卡片交互优化 (BlinkoCard UX)

针对高频操作进行了路径缩短与视觉降噪处理。

### 5.1 下拉菜单重构 (Dropdown Menu)
*   **首行速操作**: 将高频使用的 **[评论]**、**[AI标签]**、**[编辑]** 提权至菜单首行。
*   **水平并列**: 采用图标+微型文本的水平布局 (Flex Row)，显著压缩了菜单的垂直长度。
*   **自动收起**: 优化了点击反馈，点击首行任一图标后自动关闭下拉菜单。

### 5.2 侧边栏折叠 (Sidebar)
*   **区域收纳**: 将 "Statistics" / "Resources" / "Archive" 等低频区域默认折叠。
*   **Show More**: 增加展开/收起切换器，减少侧边栏视觉噪音，聚焦核心笔记功能。

---

## 6. 移动端编辑器工具栏重构 (Mobile Toolbar Redesign)

针对移动端小屏幕设备，对编辑器底部工具栏进行了结构性重构，以解决按钮拥挤、溢出和不可见的问题。

### 6.1 双行布局架构 (Dual-Row Layout)
*   **🔴 问题**: 随着插件和 AI 功能的增加，单行工具栏在 iPhone SE 等设备上严重溢出，导致发送按钮被挤出屏幕或与插件图标堆叠。
*   **🟢 方案**: 将底部工具栏升级为双行布局：
    *   **第一行（核心区）**: 放置 [笔记类型]、[标签]、[上传]、[录音]，右侧固定 [全屏] 和 [发送]。
    *   **第二行（扩展区）**: 放置 [引用]、[AI 写作] 以及所有通过插件机制添加的自定义按钮（如 AI 美化）。
*   **视觉隔离**: 在两行之间添加了 `1px` 的极细分割线，使功能分区更加清晰。

### 6.2 触控人体工学优化 (Touch Targets)
*   **44px 标准**: 遵循 Apple/Google 规范，将所有底部按钮的点击容器提升至 **44px**（原 40px），图标放大至 **26px**。
*   **发送按钮扁平化**: 为了优化垂直节奏，将发送按钮调整为 **56x36px** 的扁平椭圆状，既保留了大触控面积，又增加了与分割线之间的视觉呼吸感，防止上下按钮显得过于拥挤。

---

## 7. 首屏秒开与布局稳定性 (Instant Start & Layout Stability)

### 7.1 快照化加载 (Snapshot Loading Pattern)
*   **原理**: 为 `fonts.list` (字体列表) 和 `config.list` (全局配置) 引入了基于 `LocalStorage` 的**快照回显机制**。
*   **体验**: 刷新页面后，UI 瞬间从快照恢复（零延迟），随后在后台异步发起 API 请求进行对比和静默更新，彻底解决了首屏渲染时的视觉跳变（FOUC）。

### 7.2 CSS 变量驱动布局 (CSS-Driven Layout)
*   **方案**: 将 SideBar 的动态宽度计算从 MobX 响应式 JS 直接驱动迁移为 **CSS 变量 (`--sidebar-width`)** 模式。
*   **优势**: 缩放侧边栏时不再触发布局抖动 (Forced Reflow)，渲染更高效，消除了 Chrome 控制台中的性能警报。
